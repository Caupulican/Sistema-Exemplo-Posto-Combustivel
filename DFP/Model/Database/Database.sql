SET SQL DIALECT 3;

SET NAMES WIN1252;

SET CLIENTLIB 'fbclient.dll';  -- DLL x32 usada, firebird super classic

CREATE DATABASE 'C:\DB\DFP.fdb'
USER 'SYSDBA' PASSWORD 'masterkey'
PAGE_SIZE 8192
DEFAULT CHARACTER SET WIN1252 COLLATION WIN1252;

CONNECT 'C:\DB\DFP.fdb' USER 'SYSDBA' PASSWORD 'masterkey';


CREATE TABLE ABASTECIMENTOS (
    ABAS_ID               INTEGER GENERATED BY DEFAULT AS IDENTITY (START WITH 1) PRIMARY KEY,
    ABAS_BOM_ID           INTEGER NOT NULL,
    ABAS_DATA_VENDA  DATE DEFAULT CURRENT_DATE,
    ABAS_QTD_LITROS       DECIMAL(10,2) NOT NULL,
    ABAS_TOTAL_ABASTECIDO   DECIMAL(10,2) DEFAULT 0.00,
    ABAS_PERCENTUAL_IMPOSTO  DECIMAL(10,2) DEFAULT 0.00,
    ABAS_TOTAL_COM_IMPOSTO DECIMAL(10,2) DEFAULT 0.00,
    ABAS_TIPO             CHAR(1)
);

CREATE TABLE BOMBAS (
    BOM_ID            INTEGER GENERATED BY DEFAULT AS IDENTITY (START WITH 1) PRIMARY KEY,
    BOM_DESCRICAO     VARCHAR(25) NOT NULL,
    BOM_TAN_ID        INTEGER
);

CREATE TABLE TANQUES (
    TAN_ID         INTEGER GENERATED BY DEFAULT AS IDENTITY (START WITH 1) PRIMARY KEY,
    TAN_DESCRICAO  VARCHAR(15) NOT NULL,
    TAN_TIPO       CHAR(1)
);

ALTER TABLE ABASTECIMENTOS ADD CONSTRAINT FK_ABASTECIMENTOS_1 FOREIGN KEY (ABAS_BOM_ID) REFERENCES BOMBAS (BOM_ID);
ALTER TABLE BOMBAS ADD CONSTRAINT FK_BOMBAS_1 FOREIGN KEY (BOM_TAN_ID) REFERENCES TANQUES (TAN_ID);


INSERT INTO TANQUES (TAN_ID, TAN_DESCRICAO, TAN_TIPO) VALUES (1, 'GASOLINA', 'G');
INSERT INTO TANQUES (TAN_ID, TAN_DESCRICAO, TAN_TIPO) VALUES (2, 'ÓLEO DIESEL', 'D');
INSERT INTO BOMBAS (BOM_ID, BOM_DESCRICAO, BOM_TAN_ID) VALUES (1, 'BOMBA DE GASOLINA 01', 1);
INSERT INTO BOMBAS (BOM_ID, BOM_DESCRICAO, BOM_TAN_ID) VALUES (2, 'BOMBA DE GASOLINA 02', 1);
INSERT INTO BOMBAS (BOM_ID, BOM_DESCRICAO, BOM_TAN_ID) VALUES (3, 'BOMBA DE ÓLEO DIESEL 01', 2);
INSERT INTO BOMBAS (BOM_ID, BOM_DESCRICAO, BOM_TAN_ID) VALUES (4, 'BOMBA DE ÓLEO DIESEL 02', 2);

COMMIT WORK;
